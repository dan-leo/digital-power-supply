Version 4
SHEET 1 3780 1636
WIRE 288 -96 128 -96
WIRE -400 -32 -608 -32
WIRE 352 -32 288 -32
WIRE 352 -16 352 -32
WIRE 368 -16 352 -16
WIRE 480 -16 448 -16
WIRE 592 -16 560 -16
WIRE -880 0 -880 -32
WIRE 288 0 288 -32
WIRE 1040 0 896 0
WIRE 1152 0 1040 0
WIRE 1360 0 1152 0
WIRE 1568 0 1360 0
WIRE -400 16 -400 -32
WIRE -400 16 -432 16
WIRE -368 16 -400 16
WIRE 560 16 560 -16
WIRE 1040 16 1040 0
WIRE -496 48 -496 16
WIRE -496 48 -528 48
WIRE -304 48 -304 16
WIRE -240 48 -304 48
WIRE -144 48 -240 48
WIRE -528 64 -528 48
WIRE -80 64 -80 48
WIRE -64 64 -80 64
WIRE 976 64 928 64
WIRE 1152 64 1152 0
WIRE 1360 64 1360 0
WIRE 1568 64 1568 0
WIRE 1888 64 1872 64
WIRE -496 80 -496 48
WIRE -400 80 -432 80
WIRE -368 80 -400 80
WIRE -304 80 -304 48
WIRE 288 80 288 64
WIRE 480 80 480 64
WIRE 1888 80 1888 64
WIRE 1968 96 1936 96
WIRE 1056 112 1040 112
WIRE 1088 112 1056 112
WIRE -880 128 -880 80
WIRE -400 128 -400 80
WIRE -400 128 -880 128
WIRE -240 144 -240 48
WIRE 2080 144 1936 144
WIRE 2080 160 2080 144
WIRE 1056 176 1056 112
WIRE 1152 176 1152 160
WIRE 1360 176 1360 160
WIRE 1568 176 1568 160
WIRE 96 192 -144 192
WIRE 192 192 96 192
WIRE 272 208 256 208
WIRE 336 208 272 208
WIRE 432 208 416 208
WIRE 464 208 432 208
WIRE 560 208 528 208
WIRE 656 208 560 208
WIRE 1888 208 1888 160
WIRE -240 224 -240 208
WIRE 192 224 160 224
WIRE 768 224 720 224
WIRE 800 224 768 224
WIRE 928 224 928 64
WIRE 928 224 880 224
WIRE -16 240 -96 240
WIRE 656 240 624 240
WIRE -144 256 -144 192
WIRE 432 256 432 208
WIRE 928 256 928 224
WIRE 960 256 928 256
WIRE 1056 256 1056 176
WIRE 1056 256 1040 256
WIRE 1072 256 1056 256
WIRE 1360 256 1152 256
WIRE 1568 256 1360 256
WIRE 2080 256 2080 240
WIRE 688 272 688 256
WIRE 768 288 768 224
WIRE 272 304 272 208
WIRE 928 304 928 256
WIRE 1888 320 1888 288
WIRE -608 352 -672 352
WIRE -432 352 -496 352
WIRE 1152 352 1152 256
WIRE 1152 352 992 352
WIRE 1232 352 1152 352
WIRE -144 368 -144 336
WIRE -144 368 -208 368
WIRE -96 368 -96 240
WIRE -96 368 -144 368
WIRE -80 368 -96 368
WIRE -208 384 -208 368
WIRE -16 384 -16 304
WIRE 0 384 -16 384
WIRE 96 384 96 192
WIRE 96 384 80 384
WIRE -672 400 -672 352
WIRE -496 400 -496 352
WIRE -80 400 -96 400
WIRE 96 400 96 384
WIRE 2624 432 2528 432
WIRE 160 448 160 224
WIRE 272 448 272 368
WIRE 272 448 160 448
WIRE 560 448 560 208
WIRE 560 448 272 448
WIRE 2768 448 2688 448
WIRE 2896 448 2768 448
WIRE 3024 448 2976 448
WIRE 3120 448 3024 448
WIRE 3216 448 3200 448
WIRE 624 464 624 240
WIRE 688 464 624 464
WIRE 768 464 768 352
WIRE 768 464 688 464
WIRE 832 464 768 464
WIRE 928 464 928 400
WIRE 928 464 832 464
WIRE 1152 464 1152 432
WIRE 1152 464 928 464
WIRE 1232 464 1152 464
WIRE 2624 464 2592 464
WIRE -208 480 -208 464
WIRE 160 480 160 448
WIRE 688 480 688 464
WIRE 832 496 832 464
WIRE 1152 496 1152 464
WIRE 560 512 560 448
WIRE -672 528 -672 480
WIRE -496 528 -496 480
WIRE 1968 528 1936 528
WIRE 2592 528 2592 464
WIRE 2768 528 2768 448
WIRE 2768 528 2592 528
WIRE 1840 560 1792 560
WIRE 1936 560 1936 528
WIRE 1936 560 1872 560
WIRE 2032 560 1936 560
WIRE 160 576 160 560
WIRE 688 576 688 560
WIRE 832 576 832 560
WIRE 928 576 928 560
WIRE 1040 576 1040 560
WIRE 1152 576 1152 560
WIRE 1840 576 1840 560
WIRE 2032 576 2032 560
WIRE 3024 592 3024 448
WIRE 3072 592 3024 592
WIRE 3216 608 3216 448
WIRE 3216 608 3136 608
WIRE 3408 608 3216 608
WIRE 1504 624 1504 592
WIRE 3072 624 3024 624
WIRE 3552 624 3472 624
WIRE 3616 624 3552 624
WIRE 3408 640 3360 640
WIRE 2032 672 2032 656
WIRE 2768 672 2592 672
WIRE 3552 672 3552 624
WIRE 1504 720 1504 704
WIRE 1520 720 1504 720
WIRE 1840 720 1792 720
WIRE 1936 720 1872 720
WIRE 2032 720 1936 720
WIRE -624 736 -688 736
WIRE -448 736 -512 736
WIRE 1504 736 1504 720
WIRE 1840 736 1840 720
WIRE 2032 736 2032 720
WIRE 2592 736 2592 672
WIRE 2624 736 2592 736
WIRE 2768 752 2768 672
WIRE 2768 752 2688 752
WIRE 2880 752 2768 752
WIRE 3024 752 3024 624
WIRE 3024 752 2960 752
WIRE 3104 752 3024 752
WIRE 3280 752 3184 752
WIRE 2624 768 2528 768
WIRE 3360 768 3360 640
WIRE 3552 768 3552 752
WIRE 3552 768 3360 768
WIRE 3280 784 3280 752
WIRE -688 816 -688 752
WIRE -512 816 -512 752
WIRE 688 816 672 816
WIRE 1504 816 1504 800
WIRE 672 832 672 816
WIRE 1936 864 1936 720
WIRE 1952 864 1936 864
WIRE 3552 864 3552 848
WIRE 128 896 -48 896
WIRE 368 912 192 912
WIRE -32 928 -48 928
WIRE 80 928 48 928
WIRE 128 928 80 928
WIRE 672 928 672 912
WIRE -688 944 -688 896
WIRE -512 944 -512 896
WIRE 80 944 80 928
WIRE 368 960 368 912
WIRE 1728 992 1616 992
WIRE 672 1008 672 992
WIRE 1616 1008 1616 992
WIRE 80 1040 80 1024
WIRE 1104 1040 928 1040
WIRE 2320 1040 2208 1040
WIRE 1200 1056 1168 1056
WIRE 1328 1056 1200 1056
WIRE 1424 1056 1392 1056
WIRE 1488 1056 1424 1056
WIRE 1552 1056 1488 1056
WIRE 368 1072 368 1040
WIRE 1072 1072 928 1072
WIRE 1104 1072 1072 1072
WIRE 2208 1072 2208 1040
WIRE 1552 1088 1552 1056
WIRE 1568 1088 1552 1088
WIRE 1424 1104 1424 1056
WIRE 1488 1104 1488 1056
WIRE 1616 1120 1616 1104
WIRE 1200 1136 1200 1056
WIRE 368 1152 368 1136
WIRE 672 1152 672 1104
WIRE 2208 1168 2208 1152
WIRE 1424 1200 1424 1184
WIRE 1488 1200 1488 1168
WIRE 1072 1216 1072 1072
WIRE 1200 1216 1200 1200
WIRE 1200 1216 1072 1216
WIRE 1488 1296 1488 1280
FLAG 688 576 0
FLAG 1152 576 0
FLAG -432 352 Vcc
FLAG 224 176 0
FLAG 1616 1120 0
FLAG 160 576 0
FLAG 1136 1024 0
FLAG 672 1152 0
FLAG 2032 672 0
FLAG 880 144 0
FLAG 2032 816 0
FLAG 560 576 0
FLAG 896 0 Vcc
FLAG 160 880 0
FLAG 928 1040 Curr_sense
FLAG 1056 176 base
FLAG 1296 112 base
FLAG 1504 112 base
FLAG -528 64 0
FLAG -64 64 Vcc
FLAG 592 -16 Vsteady
FLAG 688 272 Vsteady
FLAG 224 240 Vsteady
FLAG 1136 1088 Vsteady
FLAG 160 944 Vsteady
FLAG 3104 576 Vsteady
FLAG -240 224 0
FLAG -608 352 Vsteady
FLAG -672 528 0
FLAG -448 736 Vcc
FLAG -512 944 0
FLAG -624 736 Vsteady
FLAG -688 944 0
FLAG 432 256 CCCV_switch
FLAG 1728 992 CCCV_switch
FLAG 1504 816 0
FLAG 1504 592 Vsteady
FLAG 1840 816 0
FLAG 1840 656 0
FLAG 1520 720 Vzener
FLAG 1712 720 Vzener
FLAG 1712 560 Vzener
FLAG 1952 864 CurrAdj
FLAG 928 1072 CurrAdj
FLAG 1968 528 VoltAdj
FLAG -96 400 VoltAdj
FLAG -400 -32 Vtransformer
FLAG 288 80 0
FLAG 128 -96 Vtransformer
FLAG 480 80 0
FLAG 688 816 Vcc
FLAG 368 1152 0
FLAG 560 80 0
FLAG -48 896 Curr_sense
FLAG 96 464 0
FLAG -48 352 Vsteady
FLAG -48 416 0
FLAG -208 480 0
FLAG 80 1040 0
FLAG -48 928 CurrAdj
FLAG 2208 1168 0
FLAG 2320 1040 Vneg
FLAG 1232 464 Vout
IOPIN 1232 464 Out
FLAG 1872 64 Vout
IOPIN 1872 64 In
FLAG 2080 256 0
FLAG 1888 320 0
FLAG 1968 96 0
FLAG 688 192 0
FLAG 1232 352 Vcurr
FLAG -496 528 0
FLAG 2528 432 Vout
IOPIN 2528 432 In
FLAG 2528 768 Vcurr
FLAG 2656 480 Vsteady
FLAG 2656 720 Vsteady
FLAG 3280 784 0
FLAG 2656 784 Vneg
FLAG 2656 416 Vneg
FLAG 3104 640 Vneg
FLAG 3440 656 Vsteady
FLAG 3440 592 Vneg
FLAG 3552 864 0
FLAG 3616 624 Curr_sense
FLAG 1040 576 0
FLAG 928 576 0
FLAG 832 576 0
FLAG 1424 1200 0
FLAG 1488 1296 0
SYMBOL res 896 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 180R
SYMBOL voltage -496 384 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL res 672 464 R0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL cap 1136 496 R0
SYMATTR InstName C1
SYMATTR Value 10µF
SYMATTR SpiceLine Rser=0.1
SYMBOL res 1056 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 8k
SYMBOL res 432 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res -128 352 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R10
SYMATTR Value 50k
SYMBOL res -192 368 M0
SYMATTR InstName R11
SYMATTR Value 50k
SYMBOL res 688 928 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL LED 656 928 R0
SYMATTR InstName D1
SYMBOL voltage 2032 560 M0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -270 92 Left 2
SYMATTR Value PULSE(0 5 1ms)
SYMATTR InstName V3
SYMBOL cap 864 80 R0
WINDOW 3 -59 56 Left 2
SYMATTR Value 470n
SYMATTR InstName C2
SYMBOL voltage 2032 720 M0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -299 123 Left 2
SYMATTR Value 0.5
SYMATTR InstName V4
SYMBOL cap 544 512 R0
SYMATTR InstName C3
SYMATTR Value 5n
SYMBOL res 96 1040 R180
WINDOW 0 43 36 Left 2
WINDOW 3 36 14 Left 2
SYMATTR InstName R18
SYMATTR Value 470k
SYMBOL npn 976 16 R0
SYMATTR InstName Q2
SYMBOL npn 1088 64 R0
SYMATTR InstName Q3
SYMBOL res 1136 160 R0
SYMATTR InstName R2
SYMATTR Value 0.1
SYMATTR SpiceLine tol=1%
SYMBOL npn 1296 64 R0
SYMATTR InstName Q4
SYMBOL res 1344 160 R0
SYMATTR InstName R3
SYMATTR Value 0.1
SYMATTR SpiceLine tol=1%
SYMBOL npn 1504 64 R0
SYMATTR InstName Q5
SYMBOL res 1552 160 R0
SYMATTR InstName R12
SYMATTR Value 0.1
SYMATTR SpiceLine tol=1%
SYMBOL voltage -880 -16 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value SINE(0 25.2 50)
SYMBOL res -704 -16 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R13
SYMATTR Value 3
SYMBOL diode -496 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMBOL diode -368 32 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 -5 34 VBottom 2
SYMATTR InstName D3
SYMBOL diode -368 64 M90
WINDOW 0 67 30 VBottom 2
WINDOW 3 -27 17 VTop 2
SYMATTR InstName D4
SYMBOL diode -496 64 M90
WINDOW 0 60 29 VBottom 2
WINDOW 3 -32 16 VTop 2
SYMATTR InstName D5
SYMBOL cap -256 144 R0
SYMATTR InstName C4
SYMATTR Value 10m
SYMATTR SpiceLine Rser=0.1
SYMBOL res -48 944 R270
WINDOW 0 -31 23 VTop 2
WINDOW 3 -3 76 VBottom 2
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL voltage -672 384 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value 14.3
SYMBOL zener 1520 800 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
SYMATTR Value 1N750
SYMBOL res 1488 608 R0
SYMATTR InstName R15
SYMATTR Value 5.6k
SYMBOL res 1696 736 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R16
SYMATTR Value 5k
SYMBOL res 1824 720 R0
SYMATTR InstName R23
SYMATTR Value 5k
SYMBOL res 1696 576 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R24
SYMATTR Value 5k
SYMBOL res 1824 560 R0
SYMATTR InstName R25
SYMATTR Value 5k
SYMBOL diode 272 -96 R0
WINDOW 0 5 -19 Left 2
WINDOW 3 -23 46 Left 2
SYMATTR InstName D8
SYMBOL cap 272 0 R0
SYMATTR InstName C6
SYMATTR Value 10m
SYMATTR SpiceLine Rser=0.1
SYMBOL res 464 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 1m
SYMBOL res 464 -32 R0
SYMATTR InstName R28
SYMATTR Value 1k
SYMBOL Opamps\\opamp2 688 288 M180
SYMATTR InstName U4
SYMATTR Value LM358
SYMBOL Opamps\\opamp2 224 272 M180
SYMATTR InstName U5
SYMATTR Value LM358
SYMBOL Opamps\\opamp2 1136 1120 M180
WINDOW 3 19 126 Left 2
SYMATTR Value LM358
SYMATTR InstName U1
SYMBOL Opamps\\opamp2 160 976 M180
SYMATTR InstName U2
SYMATTR Value LM358
SYMBOL Opamps\\opamp2 3104 544 R0
SYMATTR InstName U3
SYMATTR Value LM358
SYMBOL npn 608 1008 R0
SYMATTR InstName Q6
SYMBOL res 384 1056 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R29
SYMATTR Value 1k
SYMBOL cap 352 1072 R0
SYMATTR InstName C7
SYMATTR Value 100n
SYMBOL cap 544 16 R0
SYMATTR InstName C10
SYMATTR Value 100p
SYMATTR SpiceLine Rser=0.01
SYMBOL Opamps\\opamp2 -48 320 R0
WINDOW 3 -48 130 Left 2
WINDOW 0 -49 109 Left 2
SYMATTR Value LM358
SYMATTR InstName U6
SYMBOL res -16 400 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -5 51 VBottom 2
SYMATTR InstName R17
SYMATTR Value 1k
SYMBOL cap 80 400 R0
SYMATTR InstName C8
SYMATTR Value 10µ
SYMBOL diode 464 224 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D6
SYMBOL res 144 464 R0
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL cap 752 288 R0
SYMATTR InstName C5
SYMATTR Value 100p
SYMBOL cap 1472 1104 R0
SYMATTR InstName C9
SYMATTR Value 100n
SYMBOL cap 256 304 R0
WINDOW 3 -44 66 Left 2
SYMATTR Value 1000p
SYMATTR InstName C11
SYMBOL cap -32 304 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C12
SYMATTR Value 1000pF
SYMBOL cap 1184 1200 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C13
SYMATTR Value 100p
SYMBOL nmos 1568 1008 R0
SYMATTR InstName M1
SYMATTR Value AON6242
SYMBOL voltage 2208 1056 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V6
SYMATTR Value -1
SYMBOL res 1872 192 R0
SYMATTR InstName R32
SYMATTR Value 5
SYMBOL sw 1888 64 M0
WINDOW 0 38 39 Left 2
SYMATTR InstName S1
SYMATTR Value SW1
SYMBOL voltage 2080 144 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V7
SYMATTR Value PULSE(0 5 25ms 1n 1n 2m 0 1)
SYMBOL Opamps\\opamp2 2656 512 M180
SYMATTR InstName U7
SYMATTR Value LM358
SYMBOL Opamps\\opamp2 2656 688 R0
SYMATTR InstName U8
SYMATTR Value LM358
SYMBOL res 2880 464 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R19
SYMATTR Value 90k
SYMBOL res 3104 464 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL res 2976 736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 90k
SYMBOL res 3200 736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R30
SYMATTR Value 10k
SYMBOL res 1136 336 R0
SYMATTR InstName R22
SYMATTR Value 0.2
SYMBOL npn 992 304 M0
SYMATTR InstName Q1
SYMATTR Value 2N2222
SYMBOL Opamps\\opamp2 3440 688 M180
SYMATTR InstName U9
SYMATTR Value LM358
SYMBOL res 3536 752 R0
SYMATTR InstName R31
SYMATTR Value 1k
SYMBOL res 3536 656 R0
SYMATTR InstName R33
SYMATTR Value 44.5k
SYMBOL cap 1024 496 R0
SYMATTR InstName C14
SYMATTR Value 100µF
SYMATTR SpiceLine Rser=0.1
SYMBOL cap 912 496 R0
SYMATTR InstName C15
SYMATTR Value 100µF
SYMATTR SpiceLine Rser=0.1
SYMBOL cap 816 496 R0
SYMATTR InstName C16
SYMATTR Value 100n
SYMATTR SpiceLine Rser=0.05
SYMBOL diode 1328 1072 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D9
SYMBOL res 1440 1200 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res 1472 1184 R0
SYMATTR InstName R26
SYMATTR Value 100
TEXT -1176 544 Left 2 ;.STEP param RL 0.5k 1k 0.5k\n.STEP param Vadj 0 5 1\n.STEP param Cur 0 10 1\n.STEP param RL 1 20\n \n.op\n.STEP param I_load 0 0.5
TEXT -1176 480 Left 2 !.inc LM358.101
TEXT -1168 800 Left 2 ;.op\n.STEP param Vadj 0 7.5 2
TEXT -1176 424 Left 2 ;.OPTIONS plotwinsize=0
TEXT -1168 272 Left 2 ;.op\n.STEP param RL 1 20
TEXT -1168 384 Left 2 ;.tran 100us
TEXT -1160 240 Left 2 !.tran 100ms
TEXT -520 1008 Left 2 ;SINE(15 1 50)
TEXT -856 1008 Left 2 ;SINE(14.3 0.1 50)
TEXT 1352 824 Left 2 ;2.4V
TEXT 2104 272 Left 2 !.model SW1 SW(Ron=0.0001 Roff=10Meg Vt=1.1 Vh=0.1)
TEXT 2072 680 Left 2 ;SINE(4 4 5 10ms 0 90 5)
TEXT 2072 872 Left 2 ;PULSE(3 -0.1 0 0 8000ms)
